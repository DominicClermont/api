
prefix crmdig: <http://www.ics.forth.gr/isl/CRMext/CRMdig.rdfs/>  
prefix crmsci: <http://www.ics.forth.gr/isl/CRMsci/>

SELECT DISTINCT ?id ?obj ?place  ?description  ?desc_line ?summary ?material ?technique
WHERE {
  GRAPH <http://data.silknow.org/vam> {

     ?dig a crmdig:D1_Digital_Object . }

     ?dig  ecrm:P129_is_about ?obs .

 OPTIONAL { ?obs a crmsci:S4_Observation . }

OPTIONAL {
     ?obs ecrm:P3_has_note ?description ;
          ecrm:P2_has_type "physical_description" . }
OPTIONAL {
     ?obs ecrm:P3_has_note ?desc_line ;
          ecrm:P2_has_type "descriptive_line" . }
OPTIONAL {
     ?obs ecrm:P3_has_note ?summary ;
          ecrm:P2_has_type "summary" .

}
     ?dig ecrm:P129_is_about ?obj .
     ?dig ecrm:P129_is_about ?prd .



OPTIONAL {
 { ?prd ecrm:P8_took_place_on_or_within ?l
     { SELECT ?l SAMPLE(?loc) as ?place
          WHERE { ?l geonames:countryCode ?loc}
       } . FILTER(isIRI(?l)) }
}
        OPTIONAL {
       { ?prd ecrm:P126_employed ?x
       { SELECT ?x SAMPLE(?lab) as ?material
         WHERE { ?x skos:prefLabel ?lab . FILTER (lang(?lab) = "en")}
       } . FILTER(isIRI(?x)) }
}     

  OPTIONAL {
  { ?prd ecrm:P32_used_general_technique ?y
    { SELECT ?y SAMPLE(?tec) as ?technique
      WHERE { ?y skos:prefLabel ?tec . FILTER (lang(?tec) = "en")}
       } . FILTER(isIRI(?y)) }
}

     ?obj  dc:identifier ?id .

}

